webpackJsonp([29,51],{12:function(e,t){"use strict";function a(e,t){var a={data:e.data||[],destroy:!0,scrollXInner:"100%",dom:e.dom||'<"top"f>rt<"bottom"lip>',columns:e.columns||[],language:{sProcessing:"处理中...",sLengthMenu:"显示 _MENU_ 条结果",sZeroRecords:"没有匹配结果",sInfo:"显示第 _START_ 至 _END_ 条结果，共 _TOTAL_ 条",sInfoEmpty:"显示第 0 至 0 条结果，共 0 条",sInfoFiltered:"(由 _MAX_ 条结果过滤)",sInfoPostFix:"",sSearch:"搜索:",sUrl:"",sEmptyTable:"表中数据为空",sLoadingRecords:"载入中...",sInfoThousands:",",oPaginate:{sFirst:"首页",sPrevious:"上页",sNext:"下页",sLast:"末页"},oAria:{sSortAscending:": 以升序排列此列",sSortDescending:": 以降序排列此列"}},paging:e.paging&&!0,pageLength:e.pageLength||10,columnDefs:e.columnDefs||"",order:e.order||[],createdRow:e.createdRow||null,searching:e.searching&&!0,info:e.info&&!0,ordering:e.ordering&&!0};e.scrollX&&(a.scrollX=e.scrollX);var o=void 0;return o=t?$("#"+e.id).dataTable(a):$("#"+e.id).DataTable(a)}function o(e,t,a,o){$("#"+e+" tbody").off(t,a).on(t,a,o)}function n(e){var t=$("#"+e).DataTable().row($(this).parents("tr")).data();return t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a,t.bindTableEvent=o,t.getTableItem=n},141:function(e,t){"use strict";function a(e){for(var t=[],a={},o=0;o<e.length;o++)a[e[o]]||(t.push(e[o]),a[e[o]]=1);return t}function o(e){if(!isNaN(Number(e))&&Number(e)&&Number(e)>=0){for(var t=0,a=["B","KB","M","G","T"];Math.abs(e)>=1024&&(e/=1024,t++,4!==t););var o=Number(e).toFixed(2);return o+" "+a[t]}return"0B"}function n(e,t){if(!e)return"-";var a=0,o=0,n="";o=e.length;for(var i=0;i<o;i++){var l=e.charAt(i);if(a++,escape(l).length>4&&a++,n=n.concat(l),a>=t)return n=n.concat("...")}return a<t?e:void 0}function i(e,t){var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var o in a)new RegExp("("+o+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[o]:("00"+a[o]).substr((""+a[o]).length)));return t}Object.defineProperty(t,"__esModule",{value:!0}),t.arrayUnique=a,t.unitTransform=o,t.cutStr=n,t.dateFormat=i},601:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),i=o(n),l=a(6),r=o(l),s=a(3),d=o(s),b=a(4),u=o(b),f=a(8),c=o(f),p=a(7),v=o(p),h=a(2),j=o(h),m=a(12),g=o(m),O=a(147),H=o(O),S=a(141),T=void 0,y=(0,i.default)("input",{type:"number",className:"form-control",id:"setUpdateTime",placeholder:"请设定自动更新间隔时间(s/次)"}),J=(0,i.default)("tr",{},void 0,(0,i.default)("th",{},void 0,"作业名"),(0,i.default)("th",{},void 0,"调度策略"),(0,i.default)("th",{},void 0,"上次执行时间"),(0,i.default)("th",{},void 0,"调度状态"),(0,i.default)("th",{},void 0,"执行状态"),(0,i.default)("th",{},void 0,"有效性"),(0,i.default)("th",{},void 0,"插件状态"),(0,i.default)("th",{},void 0,"执行结果")),k=(0,i.default)("tr",{},void 0,(0,i.default)("th",{},void 0,"作业名"),(0,i.default)("th",{},void 0,"调度策略"),(0,i.default)("th",{},void 0,"上次执行时间"),(0,i.default)("th",{},void 0,"调度状态"),(0,i.default)("th",{},void 0,"执行状态"),(0,i.default)("th",{},void 0,"有效性"),(0,i.default)("th",{},void 0,"插件状态"),(0,i.default)("th",{},void 0,"执行结果"),(0,i.default)("th",{},void 0,"操作")),N=function(e){function t(e){(0,d.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.jobOnlineHandler=a.jobOnlineHandler.bind(a),a.selectJob=a.selectJob.bind(a),a.onlineOKHandler=a.onlineOKHandler.bind(a),a.jobOfflineHandler=a.jobOfflineHandler.bind(a),a.offlineOKHandler=a.offlineOKHandler.bind(a),a.removeHandler=a.removeHandler.bind(a),a.removeOKHandler=a.removeOKHandler.bind(a),a.jobStopHandler=a.jobStopHandler.bind(a),a.jobStopOKHandler=a.jobStopOKHandler.bind(a),a.jobStartHandler=a.jobStartHandler.bind(a),a.jobStartOKHandler=a.jobStartOKHandler.bind(a),a.createJob=a.createJob.bind(a),a.jobDetail=a.jobDetail.bind(a),a.jobUpdateHandler=a.jobUpdateHandler.bind(a),a.jobUpdatetOKHandler=a.jobUpdatetOKHandler.bind(a),a.privilegeHandler=a.privilegeHandler.bind(a),a.readJobList=a.readJobList.bind(a),a.setUpdateTime=a.setUpdateTime.bind(a),a.updateTimeChange=a.updateTimeChange.bind(a),a.state={updateTime:6e4},a}return(0,v.default)(t,e),(0,u.default)(t,[{key:"componentWillMount",value:function(){this.props.readJobList()}},{key:"componentDidUpdate",value:function(){var e=this;this.createTable(this.props.jobManage.jobList.result.data),clearInterval(T),T=setTimeout(function(){e.props.readJobList()},this.state.updateTime)}},{key:"componentDidMount",value:function(){}},{key:"readJobList",value:function(){this.props.readJobList()}},{key:"createTable",value:function(e){var t={};t.id="jobList";var a=$("#jobList").DataTable();a.column(5).visible(!0,!1),a.column(6).visible(!0,!1),t.columns=[{data:"jobName",render:function(e,t,a,o){return e.length>20?"<span title="+e+">"+(0,S.cutStr)(e,20)+"...</span>":e},defaultContent:"-"},{data:"scheduleStrategy",defaultContent:"-"},{data:"lastStartTime",defaultContent:"-"},{data:"schStatus",render:function(e,t,a,o){return"ON"==e?"上线":"下线"},defaultContent:"-"},{data:"runStatus",defaultContent:"-"},{data:"validStatus",defaultContent:"-"},{data:"pluginStatus",defaultContent:"-"},{data:"lastResult",render:function(e,t,a,o){return"执行中"==a.runStatus?"-":"SUCCEED"==e?"成功":"FAILED"==e?"失败":"KILLED"==e?"已停止":void 0},defaultContent:"-"},{data:"privilege",defaultContent:"-"}];var o=sessionStorage.getItem("userRolePermission");o.indexOf("JOB_QUERY")!=-1&&(t.columnDefs=[{targets:8,render:function(e,t,a){var o="";return 0!==a.privilege.JOB.length?(a.privilege.JOB.indexOf("查看")!=-1&&(o+="<a href='javascript:void(0);'  class='jobDetail btn btn-default btn-xs'><i class='fa fa-file-text-o'></i> 详情</a> "),a.privilege.JOB.indexOf("操作")!=-1&&(o+="ON"==a.schStatus?"<a href='javascript:void(0);'  class='joboffline btn btn-default btn-xs'><i class='fa fa-level-down'></i> 下线</a> ":"OFF"==a.schStatus?"<a href='javascript:void(0);'  class='jobOnline btn btn-default btn-xs'><i class='fa fa-level-up'></i> 上线</a> ":" ","执行中"==a.runStatus?o+="<a href='javascript:void(0);'  class='jobStop btn btn-default btn-xs'><i class='fa fa-stop-circle'></i> 停止</a> ":"待执行"==a.runStatus&&(o+="<a href='javascript:void(0);'  class='jobStart btn btn-default btn-xs'><i class='fa fa-play-circle'></i> 执行</a> ")),a.privilege.JOB.indexOf("修改")!=-1&&(o+="<a href='javascript:void(0);' class='jobUpdate btn btn-default btn-xs'><i class='fa fa-pencil-square-o'></i> 更新</a> "),a.privilege.JOB.indexOf("授权")!=-1&&(o+="<a href='javascript:void(0);' class='privilege btn btn-default btn-xs'><i class='fa fa-wrench'></i> 授权</a> "),a.privilege.JOB.indexOf("删除")!=-1&&(o+="<a href='javascript:void(0);' class='jobRemove btn btn-default btn-xs'><i class='fa fa-trash-o'></i> 删除</a></div>")):o+="<span>  无操作权限<span/>",o}}]),t.data=e,t.scrollX=!0,t.order=[[0,"asc"]];var n=(0,g.default)(t);n.column(5).visible(!1,!0),n.column(6).visible(!1,!0),(0,m.bindTableEvent)("jobList","click","a.jobDetail",this.jobDetail),(0,m.bindTableEvent)("jobList","click","a.jobUpdate",this.jobUpdateHandler),(0,m.bindTableEvent)("jobList","click","a.jobRemove",this.removeHandler),(0,m.bindTableEvent)("jobList","click","a.jobOnline",this.jobOnlineHandler),(0,m.bindTableEvent)("jobList","click","a.joboffline",this.jobOfflineHandler),(0,m.bindTableEvent)("jobList","click","a.jobStart",this.jobStartHandler),(0,m.bindTableEvent)("jobList","click","a.jobStop",this.jobStopHandler),(0,m.bindTableEvent)("jobList","click","a.privilege",this.privilegeHandler)}},{key:"selectJob",value:function(e){var t=$("#jobList").DataTable().row($(e.currentTarget).parents("tr")).data();return this.props.saveSelectjob(t),t}},{key:"privilegeHandler",value:function(e){var t=this.selectJob(e);this.props.history.replace("/job/accredit/"+t.jobName)}},{key:"jobOnlineHandler",value:function(e){var t=this.selectJob(e);$("#jobOnline").modal(),this.refs.jobOnline.setContent("您确定要上线"+t.jobName+"作业吗？")}},{key:"onlineOKHandler",value:function(){var e=this.props.jobManage.selectJobDate.jobName;this.props.jobOnline(e),$("#jobOnline").modal("hide"),this.props.readJobList()}},{key:"jobOfflineHandler",value:function(e){var t=this.selectJob(e);$("#jobOffline").modal(),this.refs.jobOffline.setContent("您确定要下线"+t.jobName+"作业吗？")}},{key:"offlineOKHandler",value:function(){var e=this.props.jobManage.selectJobDate.jobName;this.props.jobOffline(e),$("#jobOffline").modal("hide"),this.props.readJobList()}},{key:"removeHandler",value:function(e){var t=this.selectJob(e);$("#jobRemove").modal(),this.refs.jobRemove.setContent("作业调度状态："+this.props.jobManage.selectJobDate.schStatus+"，执行状态："+this.props.jobManage.selectJobDate.runStatus+"，作业停止执行并下调度，您确定要删除"+t.jobName+"作业吗？")}},{key:"removeOKHandler",value:function(){var e=this.props.jobManage.selectJobDate.jobName;this.props.jobRemove(e),$("#jobRemove").modal("hide"),this.props.readJobList()}},{key:"jobStopHandler",value:function(e){var t=this.selectJob(e);$("#jobStop").modal(),this.refs.jobStop.setContent("您确定要停止"+t.jobName+"作业吗？")}},{key:"jobStopOKHandler",value:function(){var e=this.props.jobManage.selectJobDate.jobName;this.props.jobStop(e),$("#jobStop").modal("hide"),this.props.readJobList()}},{key:"jobStartHandler",value:function(e){var t=this.selectJob(e);$("#jobStart").modal(),this.refs.jobStart.setContent("您确定要开始执行"+t.jobName+"作业吗？")}},{key:"jobStartOKHandler",value:function(){var e=this,t=this.props.jobManage.selectJobDate.jobName;this.props.jobStart(t),$("#jobStart").modal("hide"),setTimeout(function(){e.props.readJobList()},1e3)}},{key:"createJob",value:function(){this.props.history.replace("/job/add")}},{key:"jobDetail",value:function(e){var t=this.selectJob(e);this.props.history.replace("/job/detail/"+t.jobName)}},{key:"jobUpdateHandler",value:function(e){var t=this.selectJob(e),a=this.props.jobManage.selectJobDate;"ON"==a.schStatus||"执行中"==a.runStatus?($("#jobUpdate").modal(),this.refs.jobUpdate.setContent("检测到"+t.jobName+"作业正在处于调度状态或正在执行，继续执行会自动停止并下调度，您确定要更新吗？")):this.props.history.replace("/job/update/"+t.jobName)}},{key:"jobUpdatetOKHandler",value:function(){var e=this.props.jobManage.selectJobDate.jobName;this.props.isRun(e),0==this.props.jobManage.isRunning.code&&($("#jobUpdate").modal("hide"),this.props.history.replace("/job/update/"+e))}},{key:"setUpdateTime",value:function(){$("#updataTime").modal(),this.refs.updataTime.setContent(y)}},{key:"updateTimeChange",value:function(){this.setState({updateTime:1e3*Number($("#setUpdateTime").val())}),$("#updataTime").modal("hide")}},{key:"render",value:function(){var e=J,t=sessionStorage.getItem("userRolePermission");t.indexOf("JOB_")!=-1&&(e=k);var a=void 0;return t.indexOf("JOB_CREATE")!=-1&&(a=(0,i.default)("button",{type:"submit",className:"btn btn-primary",onClick:this.createJob},void 0,"新建")),(0,i.default)("div",{id:"jobManage",className:"box box-primary"},void 0,(0,i.default)("div",{className:"row"},void 0,(0,i.default)("div",{className:"col-md-12"},void 0,(0,i.default)("div",{className:"box-header",style:{float:"left"}},void 0,a,(0,i.default)("small",{style:{padding:"15px 10px"}},void 0,"作业列表更新时间为: ",this.state.updateTime/1e3," (s/次)",(0,i.default)("a",{href:"javascript:;",onClick:this.readJobList},void 0," 更新 ")," | ",(0,i.default)("a",{href:"javascript:;",onClick:this.setUpdateTime},void 0," 设置 "))),(0,i.default)("div",{className:"box-body"},void 0,(0,i.default)("table",{id:"jobList",className:"table table-striped table-bordered"},void 0,(0,i.default)("thead",{},void 0,e))))),j.default.createElement(H.default,{modalId:"jobOnline",ref:"jobOnline",title:"上线作业",okHandler:this.onlineOKHandler}),j.default.createElement(H.default,{modalId:"jobOffline",ref:"jobOffline",title:"下线作业",okHandler:this.offlineOKHandler}),j.default.createElement(H.default,{modalId:"jobRemove",ref:"jobRemove",title:"删除作业",okHandler:this.removeOKHandler}),j.default.createElement(H.default,{modalId:"jobStop",ref:"jobStop",title:"停止作业",okHandler:this.jobStopOKHandler}),j.default.createElement(H.default,{modalId:"jobStart",ref:"jobStart",title:"执行作业",okHandler:this.jobStartOKHandler}),j.default.createElement(H.default,{modalId:"jobUpdate",ref:"jobUpdate",title:"更新作业",okHandler:this.jobUpdatetOKHandler}),j.default.createElement(H.default,{modalId:"updataTime",ref:"updataTime",title:"更新时间",okHandler:this.updateTimeChange}))}}]),t}(h.Component);t.default=N}});