webpackJsonp([40,51],{628:function(e,a,r){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(a,"__esModule",{value:!0});var t=r(5),l=s(t),o=r(17),d=s(o),i=r(16),n=s(i),m=r(6),u=s(m),c=r(3),f=s(c),p=r(4),v=s(p),h=r(8),b=s(h),N=r(7),g=s(N),U=r(2),y=s(U),M=(0,l.default)("div",{className:"box-header with-border "},void 0,(0,l.default)("p",{className:"box-title"},void 0,"基本信息")),H=(0,l.default)("label",{htmlFor:"roleName"},void 0," 角色名 : "),x=(0,l.default)("label",{},void 0,"描述: "),k=(0,l.default)("span",{className:"messages"}),L=(0,l.default)("div",{className:"box-header with-border "},void 0,(0,l.default)("p",{className:"box-title"},void 0,"用户分配")),R=(0,l.default)("label",{},void 0,"可添加用户"),_=(0,l.default)("i",{className:"fa fa-long-arrow-right col-md-12 dir-right"}),w=(0,l.default)("i",{className:"fa fa-long-arrow-left col-md-12 dir-left"}),E=(0,l.default)("label",{},void 0,"角色内用户"),C=function(e){function a(e){(0,f.default)(this,a);var r=(0,b.default)(this,(a.__proto__||(0,u.default)(a)).call(this,e));return r.addUserHander=r.addUserHander.bind(r),r.removeUserHander=r.removeUserHander.bind(r),r.saveUserHander=r.saveUserHander.bind(r),r.returnHander=r.returnHander.bind(r),r}return(0,g.default)(a,e),(0,v.default)(a,[{key:"componentWillMount",value:function(){this.props.roleManageUserList(this.props.params.id),this.props.allUserList(this.props.roleManage.roleUserList.member)}},{key:"componentDidMount",value:function(){}},{key:"addUserHander",value:function(e){for(var a=this.props.roleManage.roleUserList,r=this.props.roleManage.allUserList,s=0;s<r.member.length;s++)"admin"==r.member[s].userName&&r.splice(s,1);for(var t=document.querySelector("#select1"),l=[],o=0;o<t.length;o++)t.options[o].selected&&l.push(t[o].index);for(var d=[],i=0;i<r.member.length;i++){for(var n=!0,m=0;m<a.member.length;m++)a.member[m].userName!=r.member[i].userName&&"admin"!=r.member[i].userName||(n=!1);n&&d.push(r.member[i])}for(var u=0;u<l.length;u++)a.member.push(d[l[u]]);l.length>0&&this.props.addUserORRemoveToRole(a)}},{key:"removeUserHander",value:function(){for(var e=this.props.roleManage.roleUserList,a=this.props.roleManage.allUserList,r=0;r<a.member.length;r++)"admin"==a.member[r].userName&&a.splice(r,1);for(var s=document.querySelector("#select2"),t=[],l=0;l<s.length;l++)s.options[l].selected&&t.push(s[l].index);for(var o=[],d=0;d<a.member.length;d++){for(var i=!0,n=0;n<e.member.length;n++)e.member[n].userName!=a.member[d].userName&&"admin"!=a.member[d].userName||(i=!1);i&&o.push(a.member[d])}t.sort().reverse();for(var m=0;m<t.length;m++)e.member.splice(t[m],1);t.length>0&&this.props.addUserORRemoveToRole(e)}},{key:"saveUserHander",value:function(){for(var e=this,a=this.props.roleManage.selectRole.roleName,r=this.props.roleManage.roleUserList.member,s=[],t=0;t<r.length;t++)s.push(r[t].userName);(0,n.default)(d.default.mark(function r(){return d.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.props.saveUserRole(a,s);case 2:0==e.props.roleManage.isSave.code&&e.props.history.replace("/roleManage");case 3:case"end":return r.stop()}},r,e)}))()}},{key:"returnHander",value:function(){this.props.history.replace("/roleManage")}},{key:"render",value:function(){var e=void 0,a=void 0,r=this.props.roleManage.roleUserList.member,s=this.props.roleManage.allUserList.member;if(void 0!=r&&void 0!=s){for(var t=0;t<s.length;t++)"admin"==s[t].userName&&s.splice(t,1);e=r.map(function(e,a){return(0,l.default)("option",{value:e.userName},void 0,e.userName+" ("+e.name+")")});for(var o=[],d=0;d<s.length;d++){for(var i=!0,n=0;n<r.length;n++)r[n].userName!=s[d].userName&&"admin"!=s[d].userName||(i=!1);i&&o.push(s[d])}a=o.map(function(e,a){return(0,l.default)("option",{value:e.userName},void 0,e.userName+" ("+e.name+")")})}else e=a="";return(0,l.default)("div",{id:"roleEdit"},void 0,(0,l.default)("div",{className:"box box-primary"},void 0,M,(0,l.default)("div",{className:"box-body"},void 0,(0,l.default)("div",{className:""},void 0,(0,l.default)("div",{className:"roleNameDiv col-md-6 form-group"},void 0,H,(0,l.default)("span",{className:"detailSpan ml10"},void 0,this.props.params.id))),(0,l.default)("div",{className:""},void 0,(0,l.default)("div",{className:"descDiv col-md-8 form-group"},void 0,x,k,(0,l.default)("span",{className:"detailSpan ml10"},void 0,this.props.roleManage.selectRole.desc))))),(0,l.default)("div",{className:"box box-primary"},void 0,L,(0,l.default)("div",{className:"box-body"},void 0,(0,l.default)("div",{className:"form-group col-md-4"},void 0,R,y.default.createElement("select",{multiple:"multiple",id:"select1",ref:"select1",className:"form-control",size:"8"},a)),(0,l.default)("div",{className:"col-md-2 dir"},void 0,(0,l.default)("div",{className:"dir-button"},void 0,y.default.createElement("button",{ref:"add",onClick:this.addUserHander},_),y.default.createElement("button",{ref:"remove",onClick:this.removeUserHander},w))),(0,l.default)("div",{className:"form-group col-md-4"},void 0,E,y.default.createElement("select",{multiple:"multiple",id:"select2",ref:"select2",className:"form-control",size:"8"},e)))),(0,l.default)("button",{type:"submit",className:"btn btn-primary",onClick:this.returnHander},void 0,"返回"),y.default.createElement("button",{type:"submit",className:"btn ml15 btn-primary",ref:"save",onClick:this.saveUserHander},"保存"))}}]),a}(U.Component);a.default=C}});