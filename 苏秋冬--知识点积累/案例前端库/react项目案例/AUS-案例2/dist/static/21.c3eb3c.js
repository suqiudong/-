webpackJsonp([21,51],{12:function(e,t){"use strict";function a(e,t){var a={data:e.data||[],destroy:!0,scrollXInner:"100%",dom:e.dom||'<"top"f>rt<"bottom"lip>',columns:e.columns||[],language:{sProcessing:"处理中...",sLengthMenu:"显示 _MENU_ 条结果",sZeroRecords:"没有匹配结果",sInfo:"显示第 _START_ 至 _END_ 条结果，共 _TOTAL_ 条",sInfoEmpty:"显示第 0 至 0 条结果，共 0 条",sInfoFiltered:"(由 _MAX_ 条结果过滤)",sInfoPostFix:"",sSearch:"搜索:",sUrl:"",sEmptyTable:"表中数据为空",sLoadingRecords:"载入中...",sInfoThousands:",",oPaginate:{sFirst:"首页",sPrevious:"上页",sNext:"下页",sLast:"末页"},oAria:{sSortAscending:": 以升序排列此列",sSortDescending:": 以降序排列此列"}},paging:e.paging&&!0,pageLength:e.pageLength||10,columnDefs:e.columnDefs||"",order:e.order||[],createdRow:e.createdRow||null,searching:e.searching&&!0,info:e.info&&!0,ordering:e.ordering&&!0};e.scrollX&&(a.scrollX=e.scrollX);var n=void 0;return n=t?$("#"+e.id).dataTable(a):$("#"+e.id).DataTable(a)}function n(e,t,a,n){$("#"+e+" tbody").off(t,a).on(t,a,n)}function l(e){var t=$("#"+e).DataTable().row($(this).parents("tr")).data();return t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a,t.bindTableEvent=n,t.getTableItem=l},13:function(e,t){"use strict";function a(e){$(e).iCheck({checkboxClass:"icheckbox_minimal-blue",radioClass:"iradio_minimal-blue",disabledClass:"disabled"})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},141:function(e,t){"use strict";function a(e){for(var t=[],a={},n=0;n<e.length;n++)a[e[n]]||(t.push(e[n]),a[e[n]]=1);return t}function n(e){if(!isNaN(Number(e))&&Number(e)&&Number(e)>=0){for(var t=0,a=["B","KB","M","G","T"];Math.abs(e)>=1024&&(e/=1024,t++,4!==t););var n=Number(e).toFixed(2);return n+" "+a[t]}return"0B"}function l(e,t){if(!e)return"-";var a=0,n=0,l="";n=e.length;for(var r=0;r<n;r++){var i=e.charAt(r);if(a++,escape(i).length>4&&a++,l=l.concat(i),a>=t)return l=l.concat("...")}return a<t?e:void 0}function r(e,t){var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in a)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[n]:("00"+a[n]).substr((""+a[n]).length)));return t}Object.defineProperty(t,"__esModule",{value:!0}),t.arrayUnique=a,t.unitTransform=n,t.cutStr=l,t.dateFormat=r},582:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(5),r=n(l),i=a(143),s=n(i),d=a(6),o=n(d),c=a(3),u=n(c),p=a(4),m=n(p),f=a(8),v=n(f),h=a(7),b=n(h),g=a(2),y=(n(g),a(13)),N=n(y),x=a(12),T=n(x),_=a(10),w=a(141),k=a(149),z="",R={},H="",C='<select name="type" class="form-control"><option value="string">string</option><option value="long">long</option><option value="double">double</option><option value="date">date</option><option value="geo_point">geo_point</option><option value="nested">nested</option></select>',D='<select name="store" class="form-control"><option value="true">是</option><option value="false" selected>否</option></select>',O='<select name="index" class="form-control"><option value="true" selected>是</option><option value="false">否</option></select>',S='<select class="form-control" name="key"><option value="true">是</option><option value="false" selected>否</option></select>',I=(0,r.default)("option",{value:""},void 0,"请选择"),M=(0,r.default)("div",{className:"box-header with-border "},void 0,(0,r.default)("p",{className:"box-title"},void 0,"基本信息")),P=(0,r.default)("label",{htmlFor:"datasetName"},void 0,(0,r.default)("span",{className:"identify"},void 0,"* "),"名称 : "),E=(0,r.default)("div",{name:"isPartition",className:"form-group col-md-3"},void 0,(0,r.default)("label",{htmlFor:"isPartition"},void 0,(0,r.default)("span",{className:"identify"},void 0,"* "),"是否分区 : "),(0,r.default)("div",{className:"radio"},void 0,(0,r.default)("label",{},void 0,(0,r.default)("input",{name:"isPartition",type:"radio",value:"true"})," 是"),(0,r.default)("label",{className:"ml20"},void 0,(0,r.default)("input",{name:"isPartition",type:"radio",value:"false"})," 否"))),V=(0,r.default)("div",{name:"isVisible",className:"form-group col-md-3"},void 0,(0,r.default)("label",{htmlFor:"isVisible"},void 0,(0,r.default)("span",{className:"identify"},void 0,"* "),"可见性 : "),(0,r.default)("div",{className:"radio"},void 0,(0,r.default)("label",{},void 0,(0,r.default)("input",{name:"isVisible",type:"radio",value:"PUBLIC"})," 共享"),(0,r.default)("label",{className:"ml20"},void 0,(0,r.default)("input",{name:"isVisible",type:"radio",value:"PRIVATE"})," 私有"))),q=(0,r.default)("label",{},void 0,(0,r.default)("span",{className:"identify"},void 0,"* "),"分片数 : "),F=(0,r.default)("label",{},void 0,(0,r.default)("span",{className:"identify"},void 0,"* "),"副本数 : "),U=(0,r.default)("span",{className:"messages"}),A=(0,r.default)("div",{className:"box-header with-border "},void 0,(0,r.default)("p",{className:"box-title"},void 0,"字段")),J=(0,r.default)("thead",{},void 0,(0,r.default)("tr",{},void 0,(0,r.default)("th",{}),(0,r.default)("th",{},void 0,"字段名"),(0,r.default)("th",{},void 0,"字段描述"),(0,r.default)("th",{},void 0,"字段类型"),(0,r.default)("th",{},void 0,"存储"),(0,r.default)("th",{},void 0,"索引"),(0,r.default)("th",{},void 0,"分词"),(0,r.default)("th",{},void 0,"主键"),(0,r.default)("th",{},void 0,"操作"))),L=(0,r.default)("div",{className:"box-header with-border"},void 0,(0,r.default)("p",{className:"box-title"},void 0,"分区信息")),X=(0,r.default)("label",{htmlFor:"partitionField"},void 0,"分区字段："),B=(0,r.default)("label",{htmlFor:"partitionRule"},void 0,"分区规则："),j=(0,r.default)("i",{className:"fa fa-save"}),Z=function(e){function t(e){(0,u.default)(this,t);var a=(0,v.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return a.createDataSetHandler=a.createDataSetHandler.bind(a),a.selectIndexHandler=a.selectIndexHandler.bind(a),a.selectTypeHandler=a.selectTypeHandler.bind(a),a.fieldDetailHandler=a.fieldDetailHandler.bind(a),a.createNestedFieldHandler=a.createNestedFieldHandler.bind(a),a.replicationJudge=a.replicationJudge.bind(a),a.fieldInputHandler=a.fieldInputHandler.bind(a),a.schemaValidate=a.schemaValidate.bind(a),a}return(0,b.default)(t,e),(0,m.default)(t,[{key:"componentWillMount",value:function(){this.props.getDataset(this.props.params.datasetName),this.props.getMaxSettingNums(),this.props.listAnalyzers()}},{key:"componentDidUpdate",value:function(){this.crateTableHandler(),z=this.props.dataset.selectedRecord.schema.properties;for(var e="",t=0;t<this.props.dataset.analyzers.length;t++)e+='<option value="'+this.props.dataset.analyzers[t]+'">'+this.props.dataset.analyzers[t]+"</option>";H='<select name="analyzer" class="form-control" id="analyzer">'+e+"</select>"}},{key:"componentDidMount",value:function(){0==this.props.dataset.selectedRecord.isPartition&&$('div[name = "partitionArea"]').hide(),1==this.props.dataset.selectedRecord.isPartition?$('input[name="isPartition"][value="true"]',$("#datasetUpdate")).attr("checked",!0):$('input[name="isPartition"][value="false"]',$("#datasetUpdate")).attr("checked",!0),"PRIVATE"==this.props.dataset.selectedRecord.visable?$('input[name="isVisible"][value="PRIVATE"]',$("#datasetUpdate")).attr("checked",!0):$('input[name="isVisible"][value="PUBLIC"]',$("#datasetUpdate")).attr("checked",!0),$('input[name="isVisible"]:checked',$("#datasetUpdate")).attr("checked",!0),$('input[name = "isPartition"]',$("#datasetUpdate")).attr("disabled","disabled"),(0,N.default)('input[ type = "radio"]')}},{key:"crateTableHandler",value:function(){var e={};e.id="schema",e.columns=[{className:"textCenter",orderable:!1,data:null,defaultContent:""},{data:"fieldName",render:function(e,t,a){return e?e.indexOf("<input")!=-1?e:(0,w.cutStr)(e,15):e},orderable:!1},{data:"name",render:function(e,t,a){return e?e.indexOf("<input")!=-1?e:(0,w.cutStr)(e,15):e},orderable:!1},{data:"type",orderable:!1},{data:"store",render:function(e,t,a,n){return"nested"==a.type?"-":"false"==e?"否":"true"==e?"是":void 0},orderable:!1,defaultContent:D},{data:"index",render:function(e,t,a,n){return"nested"==a.type?"-":"not_analyzed"==e||"analyzed"==e?"是":"no"==e?"否":void 0},orderable:!1,defaultContent:O},{data:"analyzer",orderable:!1,defaultContent:"-"},{data:"key",render:function(e,t,a){return"nested"==a.type?"-":"false"==e?"否":"true"==e?"是":void 0},orderable:!1,defaultContent:S},{className:"",orderable:!1,data:"operation",defaultContent:"-"}],e.dom='<"top">rt<"bottom"i>',e.scrollX=!1,e.paging=!1,e.createdRow=function(e,t,a){var n="<span class='row-details row-details-close mt10 hide'></span><i class='fa fa-circle-thin mt10'></i>";"nested"===t.type&&(n="<span class='row-details row-details-close mt10'></span>"),t.fieldName.indexOf("<input")==-1&&$("td:eq(1)",e).attr("title",t.fieldName),t.name.indexOf("<input")==-1&&$("td:eq(2)",e).attr("title",t.name),$("td:eq(0)",e).html(n)},e.data=this.props.dataset.selectedRecord.schema.properties;var t=(0,T.default)(e);$("#schema").on("click","tbody td .fa-trash-o",function(){var e=$(this).parents("tr"),a=t.row(e);a.remove(),t.draw()}),$("#schema").on("click","tbody td .row-details",this.fieldDetailHandler)}},{key:"fieldDetailHandler",value:function(e){var t=$("#schema").DataTable(),a=$(e.currentTarget).parents("tr"),n=t.row(a);if(n.child.isShown()){for(var l=0;l<$("input.fieldName").length;l++)if(!/^(?!_)(?!.*?_$)[a-zA-Z0-9_]+$/.test($("input.fieldName",$(a.next())).eq(l).val()))return void $("input.fieldName",$(a.next())).eq(l).blur();$(e.currentTarget).addClass("row-details-close").removeClass("row-details-open");for(var r=n.child().find("tbody tr"),i=[],d=0;d<$(r).length;d++){var o=$(r)[d];if(0!=$("input.fieldName",$(o)).length){var c={},u=$('select[name = "type"]',$(o)).val(),p=$('select[name = "index"]',$(o)).val(),m=$('select[name = "analyzer"]',$(o)).val();c.fieldName=$("input.fieldName",$(o)).val(),c.name=$("input.name",$(o)).val(),c.type=u,"date"===u&&(c.format="yyyy-MM-dd HH:mm:ss"),c.store=$('select[name = "store"]',$(o)).val(),0!=$("input.fieldName",$(o)).length&&("false"==p?c.index="no":"string"!=u?c.index="not_analyzed":"string"==u&&"not_analyzed"==m?c.index="not_analyzed":"string"==u&&"not_analyzed"!=m&&(c.index="analyzed",c.analyzer=m)),c.key=$('select[name = "key"]',$(o)).val(),i.push(c)}}a.attr("schema",(0,s.default)(i)),n.child.hide()}else{if($(e.currentTarget).addClass("row-details-open").removeClass("row-details-close"),n.child())return void n.child.show();this.createNestedFieldHandler(n)}}},{key:"createNestedFieldHandler",value:function(e){e.child('<div id="nestRow_'+e.index()+'"><button type="submit" name="createNested" class="btn btn-sm btn-default mb5">\n                                <i class="fa fa-fw fa-plus-circle"></i>\n                                添加子字段\n                           </button>\n                           <table id="nestTable_'+e.index()+'"  class="table table-bordered" width="100%">\n                           <thead>\n                               <tr>\n                                   <th>子字段名</th>\n                                   <th>子字段描述</th>\n                                   <th>子字段类型</th>\n                                   <th>存储</th>\n                                   <th>索引</th>\n                                   <th>分词</th>\n                                   <th>主键</th>\n                                   <th>操作</th>\n                               </tr>\n                           </thead>\n                        </table></div>').show();var t={};t.id="nestTable_"+e.index(),t.columns=[{data:"fieldName",render:function(e,t){return e?e.indexOf("<input")!=-1?e:(0,w.cutStr)(e,15):e},orderable:!1},{data:"name",render:function(e,t){return e?e.indexOf("<input")!=-1?e:(0,w.cutStr)(e,15):e},orderable:!1},{data:"type",orderable:!1},{data:"store",render:function(e,t,a,n){return"false"==e?"否":"true"==e?"是":void 0},orderable:!1,defaultContent:D},{data:"index",render:function(e,t,a,n){return"not_analyzed"==e||"analyzed"==e?"是":"no"==e?"否":void 0},orderable:!1,defaultContent:O},{data:"analyzer",orderable:!1,defaultContent:"-"},{data:"key",render:function(e,t,a,n){return"false"==e?"否":"true"==e?"是":void 0},orderable:!1,defaultContent:S},{className:"",orderable:!1,data:"operation",defaultContent:"-"}],t.paging=!1,t.dom='<"top">rt<"bottom"i>',t.scrollX=!1,t.createdRow=function(e,t,a){t.fieldName.indexOf("<input")==-1&&$("td:eq(0)",e).attr("title",t.fieldName),t.name.indexOf("<input")==-1&&$("td:eq(1)",e).attr("title",t.name)},t.data=e.data().schema;var a=(0,T.default)(t);$("#nestTable_"+e.index()).on("click","tbody td .fa-trash-o",function(){var e=$(this).parents("tr"),t=a.row(e);t.remove(),a.draw()}),$('button[name = "createNested"]',$("#nestRow_"+e.index())).off("click").on("click",function(){var t=$("#nestTable_"+e.index()).DataTable();t.row.add({data:"",fieldName:'<div class="fieldNameDiv form-group"><input type="text" placeholder="支持英文、数字、下划线" name="fieldName" maxlength= "30" class="fieldName form-control"><span class="messages"></span></div>',name:'<input type="text" class="name form-control">',type:'<select name="type" class="form-control" id="a"><option value="string">string</option><option value="long">long</option><option value="double">double</option><option value="date">date</option><option value="geo_point">geo_point</option></select>',store:'<select name="store" class="form-control"  id="store"><option value="true">是</option><option value="false" selected>否</option></select>',index:'<select name="index" class="form-control"  id="index"><option value="true">是</option><option value="false">否</option></select>',analyzer:H,key:'<select class="form-control"  name="key" id="key"><option value="true">是</option><option value="false" selected>否</option></select>',operation:'<i class="fa fa-trash-o" style="cursor: pointer;" title="删除"></i>'}).draw(),$('select[name = "type"]',$("#nestTable_"+e.index())).change(function(){"string"===$(this).val()&&"true"==$(this).closest("tr").find('select[name = "index"]').val()?$(this).closest("tr").find('select[name = "analyzer"]').prop("disabled",!1):$(this).closest("tr").find('select[name = "analyzer"]').prop("disabled",!0)}),$("input.fieldName",$("#nestTable_"+e.index())).blur(function(t){var a={fieldName:{presence:{message:"请输入字段名(同级字段不能重名)"},format:{pattern:"^(?!_)(?!.*?_$)[a-zA-Z0-9_]+$",message:"请输入合法字段名"}}};(0,k.baseValidate)($(t.currentTarget).closest($(".fieldNameDiv")),a);for(var n=$(t.currentTarget).val().trim(),l=[],r=[],i=0;i<z.length;i++)"nested"==z[i].type&&r.push(z[i]);for(var s=0;s<r.length;s++)if(s+1==e.index())for(var d=0;d<z[e.index()].schema.length;d++)l.push(z[e.index()].schema[d].fieldName);if($("input.fieldName",$("#nestTable_"+e.index())).not($(t.currentTarget)).each(function(e,t){""!=$(t).val().trim()&&l.push($(t).val())}),l.indexOf(n)!=-1)return $(t.currentTarget).val(""),void $(t.currentTarget).blur()}),$('select[name = "index"]',$("#nestTable_"+e.index())).change(function(){"true"===$(this).val()&&"string"==$(this).closest("tr").find('select[name = "type"]').val()?$(this).closest("tr").find('select[name = "analyzer"]').prop("disabled",!1):$(this).closest("tr").find('select[name = "analyzer"]').prop("disabled",!0)})})}},{key:"deleteEmptyObj",value:function(e){var t=[];for(var a in e)for(var n in e[a]){if(""==n||""==e[a][n])return;t.push(e[a]);break}return t}},{key:"createDataSetHandler",value:function(){for(var e=0;e<$("input.fieldName").length;e++)""==$("input.fieldName").eq(e).val()&&$("input.fieldName").eq(e).blur();if(this.validateHandler(),$("span.messages").find("p").length>0)return void(0,_.error)("输入有异常，请检查后重新提交！");var t={};t.datasetName=$("#datasetName",$("#datasetUpdate")).val(),t.isPartition=$('input[name = "isPartition"]:checked',$("#datasetUpdate")).val(),t.visable=$('input[name = "isVisible"]:checked',$("#datasetUpdate")).val(),t.replication=$("#replication",$("#datasetUpdate")).val(),t.shard=$("#shard",$("#datasetUpdate")).val(),t.schema={},t.owner=sessionStorage.getItem("XDataUserName"),t.schema.properties=[],$("span.row-details-open",$("#schema")).click();for(var a=this.props.dataset.selectedRecord.schema.properties,n=[],l=0;l<a.length;l++)if("nested"==a[l].type){var r=$("tbody tr",$("#schema"))[l],i=a[l].schema.concat($(r).attr("schema")?JSON.parse($(r).attr("schema")):[]);a[l].schema=this.deleteEmptyObj(i),n.push(a[l])}for(var s=a.length;s<$("tbody tr",$("#schema")).length;s++){var d=$("tbody tr",$("#schema"))[s],o=$('select[name = "index"]',$(d)).val(),c=$('select[name = "type"]',$(d)).val(),u=$('select[name = "analyzer"]',$(d)).val();if(0!=$("input.fieldName",$(d)).length){var p={};p.fieldName=$("input.fieldName",$(d)).val(),p.name=$("input.name",$(d)).val(),p.type=c,"date"===c&&(p.format="yyyy-MM-dd HH:mm:ss"),"nested"===c?p.schema=$(d).attr("schema")?JSON.parse($(d).attr("schema")):[]:(p.store=$('select[name = "store"]',$(d)).val(),p.key=$('select[name = "key"]',$(d)).val(),0!=$("input.fieldName",$(d)).length&&("false"==o?p.index="no":"string"!=c?p.index="not_analyzed":"string"==c&&"not_analyzed"==u?p.index="not_analyzed":"string"==c&&"not_analyzed"!=u&&(p.index="analyzed",p.analyzer=u))),t.schema.properties.push(p)}}0!=n.length&&(t.schema.properties=t.schema.properties.concat(n)),this.props.modifyDataset(t),this.props.history.replace("/dataSet")}},{key:"handleCreateHandler",value:function(){var e=$("#schema").DataTable();e.row.add({data:"",fieldName:'<div class="fieldNameDiv form-group"><input type="text" name="fieldName" placeholder="支持英文、数字、下划线" maxlength= "30" class="fieldName fieldNamer form-control"><span class="messages"></span></div>',name:'<input type="text" class="name form-control">',type:C,store:D,index:"",analyzer:H,key:"",operation:'<i class="fa fa-trash-o" style="cursor: pointer;" title="删除"></i>'}).draw(),$('select[name = "type"]',$("#schema")).change(this.selectTypeHandler),$("input.fieldName",$("#schema")).blur(this.fieldInputHandler),$('select[name = "index"]',$("#schema")).change(this.selectIndexHandler)}},{key:"fieldInputHandler",value:function(e){var t=this.props.dataset.selectedRecord.schema.properties,a=$(e.currentTarget).val().trim(),n=[];this.schemaValidate(e);for(var l=0;l<t.length;l++)n.push(t[l].fieldName);return $("input.fieldNamer").not($(e.currentTarget)).each(function(e,t){""!=$(t).val().trim()&&n.push($(t).val())}),n.indexOf(a)!=-1?($(e.currentTarget).val(""),void $(e.currentTarget).blur()):void 0}},{key:"selectIndexHandler",value:function(e){var t=$(e.currentTarget).val();"true"===t&&"string"==$(e.currentTarget).closest("tr").find('select[name = "type"]').val()?$(e.currentTarget).closest("tr").find('select[name = "analyzer"]').prop("disabled",!1):$(e.currentTarget).closest("tr").find('select[name = "analyzer"]').prop("disabled",!0)}},{key:"schemaValidate",value:function(e){var t={fieldName:{presence:{message:"请输入字段名(同级字段不能重名)"},format:{pattern:"^(?!_)(?!.*?_$)[a-zA-Z0-9_]+$",message:"请输入合法字段名"}}};(0,k.baseValidate)($(e.currentTarget).closest($(".fieldNameDiv")),t)}},{key:"validateHandler",value:function(){var e={replication:{presence:{message:"请输入副本数"},numericality:{onlyInteger:!0,notInteger:"请输入整数",notValid:"请输入数字",greaterThanOrEqualTo:0,lessThanOrEqualTo:this.props.dataset.maxSettingNums.maxReplicationNum,notGreaterThanOrEqualTo:"最小值为 0",notLessThanOrEqualTo:"最大值为 "+this.props.dataset.maxSettingNums.maxReplicationNum}}};(0,k.baseValidate)($(".replicationJudgeDiv"),e)}},{key:"replicationJudge",value:function(e){var t={replication:{presence:{message:"请输入副本数"},numericality:{onlyInteger:!0,notInteger:"请输入整数",notValid:"请输入数字",greaterThanOrEqualTo:0,lessThanOrEqualTo:parseInt(e.target.max,10),notGreaterThanOrEqualTo:"最小值为 0",notLessThanOrEqualTo:"最大值应小于等于 "+e.target.max}}};(0,k.baseValidate)($(".replicationJudgeDiv"),t)}},{key:"selectTypeHandler",value:function(e){var t=$(e.currentTarget).val(),a=$(e.currentTarget).closest("tr").find("input.fieldName").val();if("nested"===t)$(e.currentTarget).closest("tr").find("span.row-details-close").click(),$("span.row-details",$(e.currentTarget).closest("tr")).removeClass("hide"),$("i.fa-circle-thin",$(e.currentTarget).closest("tr")).addClass("hide"),$(e.currentTarget).closest("tr").find('select[name = "store"]').prop("disabled",!0),$(e.currentTarget).closest("tr").find('select[name = "index"]').prop("disabled",!0),$(e.currentTarget).closest("tr").find('select[name = "key"]').prop("disabled",!0),$(e.currentTarget).closest("tr").find('select[name = "analyzer"]').prop("disabled",!0),delete R[a];else{var n=$("#schema").DataTable(),l=$(e.currentTarget).parents("tr"),r=n.row(l);r.child.isShown()&&($(e.currentTarget).closest("tr").find("span.row-details-open").addClass("row-details-close").removeClass("row-details-open"),r.child.hide()),$("span.row-details",$(e.currentTarget).closest("tr")).addClass("hide"),$("i.fa-circle-thin",$(e.currentTarget).closest("tr")).removeClass("hide"),$(e.currentTarget).closest("tr").find('select[name = "store"]').prop("disabled",!1),$(e.currentTarget).closest("tr").find('select[name = "index"]').prop("disabled",!1),$(e.currentTarget).closest("tr").find('select[name = "key"]').prop("disabled",!1),$(e.currentTarget).closest("tr").find('select[name = "analyzer"]').prop("disabled",!1),"date"===t?R[a]=a:delete R[a],"string"===t&&"true"==$(e.currentTarget).closest("tr").find('select[name = "index"]').val()?$(e.currentTarget).closest("tr").find('select[name = "analyzer"]').prop("disabled",!1):$(e.currentTarget).closest("tr").find('select[name = "analyzer"]').prop("disabled",!0)}}},{key:"render",value:function(){var e="",t=[I];for(var a in this.props.dataset.dateFields)t.push((0,r.default)("option",{value:a},void 0,this.props.dataset.dateFields[a]));return this.props.dataset.selectedRecord.partitionRule&&(e=this.props.dataset.selectedRecord.partitionRule),e.indexOf("d")!=-1?e=e.substring(0,e.length-1)+" 天":e.indexOf("w")!=-1?e=e.substring(0,e.length-1)+" 周":e.indexOf("M")!=-1?e=e.substring(0,e.length-1)+" 月":e.indexOf("y")!=-1&&(e=e.substring(0,e.length-1)+" 年"),(0,r.default)("div",{id:"datasetUpdate"},void 0,(0,r.default)("div",{className:"box box-primary"},void 0,M,(0,r.default)("div",{className:"box-body"},void 0,(0,r.default)("div",{className:"row"},void 0,(0,r.default)("div",{className:"col-md-6 form-group"},void 0,P,(0,r.default)("input",{type:"text",id:"datasetName",className:"form-control",disabled:!0,value:this.props.dataset.selectedRecord.datasetName})),E,V),(0,r.default)("div",{className:"row"},void 0,(0,r.default)("div",{className:"col-md-6 form-group"},void 0,q,(0,r.default)("input",{type:"number",id:"shard",className:"form-control",disabled:!0,value:this.props.dataset.selectedRecord.shard})),(0,r.default)("div",{className:"replicationJudgeDiv col-md-6 form-group"},void 0,F,U,(0,r.default)("input",{type:"text",name:"replication",id:"replication",onBlur:this.replicationJudge,min:"0",max:this.props.dataset.maxSettingNums.maxReplicationNum,defaultValue:this.props.dataset.selectedRecord.replication,className:"form-control",placeholder:"0 <= 副本数 <= "+this.props.dataset.maxSettingNums.maxReplicationNum}))))),(0,r.default)("div",{className:"box box-primary"},void 0,A,(0,r.default)("div",{className:"row box-body"},void 0,(0,r.default)("div",{className:"col-md-12"},void 0,(0,r.default)("div",{className:"box-header pull-left"},void 0,(0,r.default)("button",{type:"submit",name:"createDataset",className:"btn btn-primary",onClick:this.handleCreateHandler.bind(this)},void 0,(0,r.default)("i",{className:"fa fa-fw fa-plus-circle",style:{verticalAlign:"middle",padding:"0 8px 0 0"}}),"添加字段")),(0,r.default)("div",{className:"box-body"},void 0,(0,r.default)("table",{id:"schema",className:"table table-striped table-bordered",style:{width:"100%"}},void 0,J))))),(0,r.default)("div",{name:"partitionArea",className:"box box-primary"},void 0,L,(0,r.default)("div",{className:"partition box-body"},void 0,(0,r.default)("div",{className:"partitionDetails row"},void 0,(0,r.default)("div",{className:"form-group col-md-6"},void 0,X,(0,r.default)("span",{className:"detailSpan ml10"},void 0," ",this.props.dataset.selectedRecord.partitionField," ")),(0,r.default)("div",{className:"form-group col-md-6"},void 0,B,(0,r.default)("span",{className:"detailSpan ml10"},void 0," ",e," "))))),(0,r.default)("button",{name:"saveBtn",className:"btn btn-primary",onClick:this.createDataSetHandler},void 0,j," 保存 "))}}]),t}(g.Component);t.default=Z}});