webpackJsonp([26,51],{11:function(e,a){"use strict";function t(e){var a=e.hasOwnProperty("class")?$("."+e.class):$("#"+e.id);a.select2({placeholder:e.placeholder||"请选择",data:e.data||[],multiple:e.multiple||!1,language:e.language||"zh-CN",tags:e.tags||!1,minimumResultsForSearch:e.minimumResultsForSearch||"Infinity",val:e.val})}function s(e,a,t){var s="string"==typeof e?$("#"+e):$("."+e.class);s.off(a).on(a,t)}Object.defineProperty(a,"__esModule",{value:!0}),a.default=t,a.bindSelectEvent=s},13:function(e,a){"use strict";function t(e){$(e).iCheck({checkboxClass:"icheckbox_minimal-blue",radioClass:"iradio_minimal-blue",disabledClass:"disabled"})}Object.defineProperty(a,"__esModule",{value:!0}),a.default=t},623:function(e,a,t){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(a,"__esModule",{value:!0});var i=t(5),l=s(i),d=t(6),r=s(d),n=t(3),o=s(n),u=t(4),c=s(u),v=t(8),p=s(v),m=t(7),f=s(m),h=t(2),g=s(h),y=t(147),_=s(y),b=t(11),N=s(b),R=t(13),x=s(R),S=t(10),O=(0,l.default)("p",{className:"box-header with-border sp_user_info"},void 0,(0,l.default)("h4",{className:"ml15"},void 0,"权限管理")),E=(0,l.default)("div",{className:"col-sm-2 hidden-xs text-right"},void 0,(0,l.default)("p",{className:"sp_user"},void 0,"用户名 : "),(0,l.default)("p",{className:"sp_user_set"},void 0,"用户权限设置 : ")),k=(0,l.default)("li",{user:"presentation",className:"active"},void 0,(0,l.default)("a",{className:"sp_presentation",href:"#home",user:"tab","data-toggle":"tab"},void 0,"系统权限管理")),A=(0,l.default)("div",{className:"col-xs-2 sp_classify_name text-right sp_pluginsystem"},void 0,"插件权限: "),P=(0,l.default)("div",{className:"col-xs-2 sp_classify_name text-right sp_users"},void 0,"用户权限: "),D=(0,l.default)("div",{className:"col-xs-2 sp_classify_name text-right sp_roles"},void 0,"角色权限: "),C=(0,l.default)("div",{className:"col-xs-2 sp_classify_name text-right sp_dateset"},void 0,"数据集权限: "),T=(0,l.default)("div",{className:"col-xs-2 sp_classify_name text-right sp_report"},void 0,"报表权限: "),w=(0,l.default)("div",{className:"col-xs-2 sp_classify_name text-right sp_dashboard"},void 0,"仪表板权限: "),U=(0,l.default)("div",{className:"col-xs-2 sp_classify_name text-right sp_jobsystem"},void 0,"作业权限: "),B=function(e){function a(e){(0,o.default)(this,a);var t=(0,p.default)(this,(a.__proto__||(0,r.default)(a)).call(this,e));return t.createSelect=t.createSelect.bind(t),t.handleChange=t.handleChange.bind(t),t.privilege=t.privilege.bind(t),t.handleModify=t.handleModify.bind(t),t.modelContent=t.modelContent.bind(t),t}return(0,f.default)(a,e),(0,c.default)(a,[{key:"componentWillMount",value:function(){this.props.userSysPrivilege(this.props.usermanage.selectedRecord.userName),this.props.getSysPrivilege()}},{key:"componentDidMount",value:function(){this.handleChange()}},{key:"createSelect",value:function(e){var a={};a.id="select_user",a.data=e,a.tags=!1,a.minimumResultsForSearch=-1,(0,N.default)(a)}},{key:"handleChange",value:function(){var e=this.props.usermanage.userSysPrivilege.result.detail.privilege,a=$(".sp_detail"),t=function(t){a.each(function(a,s){s.name==t&&($.inArray($(s).attr("data-name"),e[t])!=-1?($(s).parents("label").css("color","#000"),s.checked=!0):$(s).parents("label").css("color","#d2d6de")),s.disabled=!0,(0,x.default)(s)})};for(var s in e)t(s);$(".modify").attr("disabled",!1),$(".cancel").attr("disabled",!0),$(".ensure").attr("disabled",!0)}},{key:"handleEdit",value:function(e){$(".ensure").attr("disabled",!1),$(".modify").attr("disabled",!0),$(".cancel").attr("disabled",!1);var a=$(".sp_detail");a.each(function(e,a){$(a).parents("label").css("color","#000"),a.disabled=!1,(0,x.default)(a)})}},{key:"handleModify",value:function(){var e=$(".sp_select_user").val(),a=$(".sp_detail"),t=[],s={};s.userName=e,s.privilege={},s.privilege.USER=[],s.privilege.REPORT=[],s.privilege.ROLE=[],s.privilege.DATASET=[],s.privilege.DASHBOARD=[],s.privilege.JOB=[],s.privilege.PLUGIN=[],a.each(function(e,a){a.checked&&("USER"==a.name&&s.privilege.USER.push($(a).attr("data-name")),"REPORT"==a.name&&s.privilege.REPORT.push($(a).attr("data-name")),"ROLE"==a.name&&s.privilege.ROLE.push($(a).attr("data-name")),"DATASET"==a.name&&s.privilege.DATASET.push($(a).attr("data-name")),"DASHBOARD"==a.name&&s.privilege.DASHBOARD.push($(a).attr("data-name")),"JOB"==a.name&&s.privilege.JOB.push($(a).attr("data-name")),"PLUGIN"==a.name&&s.privilege.PLUGIN.push($(a).attr("data-name")))}),t.push(s),this.props.checkSysPrivilege(t);var i=this.props.usermanage.checkSysPrivilege,l=i.result.detail.add,d=i.result.detail.remove;if("0"==i.code){var r="";if(0==l.length&&0==d.length)return;for(var n=0;n<l.length;n++)r="<li>因 <mark>"+l[n].dependency+"</mark> 权限添加, 其依赖权限影响的 <u> "+l[n].privileges+" </u> 权限将被 <strong>自动添加</strong> ;</li>",$("#dependency").append(r);for(var o=0;o<d.length;o++)r="<li>因 <mark>"+d[o].dependency+"</mark> 权限移除, 其依赖权限影响的 <u>"+d[o].privileges+"</u> 权限将被 <strong>自动移除</strong> ;</li>",$("#dependency").append(r)}else(0,S.error)(i.msg)}},{key:"modelContent",value:function(){var e=$(".sp_select_user").val(),a=(0,l.default)("ol",{id:"dependency",className:"todo-list ui-sortable"},void 0,(0,l.default)("li",{},void 0,"您确定要修改用户： ",(0,l.default)("strong",{},void 0,e)," 的系统权限吗？"));$("#dependency").html(""),this.refs.sp_modify.setContent(a)}},{key:"modifyOKHandle",value:function(){var e=$(".sp_select_user").val(),a=$(".sp_detail"),t={};t.userName=e,t.privilege={},t.privilege.USER=[],t.privilege.REPORT=[],t.privilege.ROLE=[],t.privilege.DATASET=[],t.privilege.DASHBOARD=[],t.privilege.JOB=[],t.privilege.PLUGIN=[],a.each(function(e,a){a.checked?("USER"==a.name&&t.privilege.USER.push($(a).attr("data-name")),"REPORT"==a.name&&t.privilege.REPORT.push($(a).attr("data-name")),"ROLE"==a.name&&t.privilege.ROLE.push($(a).attr("data-name")),"DATASET"==a.name&&t.privilege.DATASET.push($(a).attr("data-name")),"DASHBOARD"==a.name&&t.privilege.DASHBOARD.push($(a).attr("data-name")),"JOB"==a.name&&t.privilege.JOB.push($(a).attr("data-name")),"PLUGIN"==a.name&&t.privilege.PLUGIN.push($(a).attr("data-name"))):$(a).parents("label").css("color","#d2d6de"),a.disabled=!0,(0,x.default)(a)}),this.props.modifyUserSysPrivilege(t),$(".ensure").attr("disabled",!0),$(".cancel").attr("disabled",!0),$(".modify").attr("disabled",!1),$("#sp_modify").modal("hide"),this.props.history.replace("/usermanage/sysPrivilege/"+this.props.usermanage.selectedRecord.userName)}},{key:"return",value:function(){this.props.history.replace("/usermanage")}},{key:"privilege",value:function(e,a){var t=e[a].map(function(e){return(0,l.default)("label",{className:"col-xs-3 col-sm-2 sp_label"},void 0," ",(0,l.default)("input",{className:"sp_users_detail sp_detail",name:a,"data-Name":e,type:"checkbox"})," ",(0,l.default)("span",{},void 0," ",e," ")," ")});return t}},{key:"render",value:function(){var e=void 0,a=void 0,t=void 0,s=void 0,i=void 0,d=void 0,r=void 0,n=this.props.usermanage.getSysPrivilege.result.detail;for(var o in n)for(var u=0;u<n[o].length;u++)"USER"==o?e=this.privilege(n,o):"REPORT"==o?a=this.privilege(n,o):"ROLE"==o?t=this.privilege(n,o):"DATASET"==o?s=this.privilege(n,o):"DASHBOARD"==o?i=this.privilege(n,o):"JOB"==o?d=this.privilege(n,o):"PLUGIN"==o&&(r=this.privilege(n,o));var c=this.props.usermanage.userSysPrivilege.result.detail.userName;return(0,l.default)("div",{className:"box box-primary"},void 0,O,(0,l.default)("div",{className:"row sp_content"},void 0,E,(0,l.default)("div",{className:"col-sm-8 col-xs-12"},void 0,(0,l.default)("div",{className:"sp_select_user_div"},void 0,(0,l.default)("select",{className:"sp_select_user form-control",disabled:!0,name:"",id:"select_user"},void 0,(0,l.default)("option",{value:c},void 0,c))),(0,l.default)("div",{className:"nav-tabs-custom",style:{userSelect:"none"}},void 0,(0,l.default)("ul",{className:"nav nav-tabs",user:"tablist"},void 0,k,(0,l.default)("li",{className:"pull-right header"},void 0,(0,l.default)("button",{type:"submit",className:"return btn btn-primary",onClick:this.return.bind(this)},void 0,"返回")),(0,l.default)("li",{className:"pull-right header"},void 0,(0,l.default)("button",{type:"submit",className:"modify btn btn-primary",onClick:this.handleEdit.bind(this)},void 0,"修改"))),(0,l.default)("div",{className:"tab-content"},void 0,(0,l.default)("div",{user:"tabpanel",className:"tab-pane active",id:"home"},void 0,(0,l.default)("div",{className:"row sp_classify"},void 0,A,(0,l.default)("div",{className:"row col-xs-10 text-center"},void 0,r)),(0,l.default)("div",{className:"row sp_classify"},void 0,P,(0,l.default)("div",{className:"userDiv row col-xs-10 text-center"},void 0,e)),(0,l.default)("div",{className:"row sp_classify"},void 0,D,(0,l.default)("div",{className:"row col-xs-10 text-center"},void 0,t)),(0,l.default)("div",{className:"row sp_classify"},void 0,C,(0,l.default)("div",{className:"row col-xs-10 text-center"},void 0,s)),(0,l.default)("div",{className:"row sp_classify"},void 0,T,(0,l.default)("div",{className:" row col-xs-10 text-center"},void 0,a)),(0,l.default)("div",{className:"row sp_classify"},void 0,w,(0,l.default)("div",{className:" row col-xs-10 text-center"},void 0,i)),(0,l.default)("div",{className:"row sp_classify"},void 0,U,(0,l.default)("div",{className:" row col-xs-10 text-center"},void 0,d))))),(0,l.default)("button",{type:"button",className:"ensure btn btn-primary sp_btn","data-toggle":"modal","data-target":"#sp_modify",onClick:this.modelContent},void 0,"保存"),(0,l.default)("button",{type:"button",className:"cancel btn btn-primary sp_btn",onClick:this.handleChange},void 0,"取消"))),g.default.createElement(_.default,{modalId:"sp_modify",ref:"sp_modify",title:"修改权限确认",loadModalControlHandler:this.handleModify,okHandler:this.modifyOKHandle.bind(this)}))}}]),a}(h.Component);a.default=B}});