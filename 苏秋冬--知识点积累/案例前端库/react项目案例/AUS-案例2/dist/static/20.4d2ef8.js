webpackJsonp([20,51],{12:function(e,a){"use strict";function t(e,a){var t={data:e.data||[],destroy:!0,scrollXInner:"100%",dom:e.dom||'<"top"f>rt<"bottom"lip>',columns:e.columns||[],language:{sProcessing:"处理中...",sLengthMenu:"显示 _MENU_ 条结果",sZeroRecords:"没有匹配结果",sInfo:"显示第 _START_ 至 _END_ 条结果，共 _TOTAL_ 条",sInfoEmpty:"显示第 0 至 0 条结果，共 0 条",sInfoFiltered:"(由 _MAX_ 条结果过滤)",sInfoPostFix:"",sSearch:"搜索:",sUrl:"",sEmptyTable:"表中数据为空",sLoadingRecords:"载入中...",sInfoThousands:",",oPaginate:{sFirst:"首页",sPrevious:"上页",sNext:"下页",sLast:"末页"},oAria:{sSortAscending:": 以升序排列此列",sSortDescending:": 以降序排列此列"}},paging:e.paging&&!0,pageLength:e.pageLength||10,columnDefs:e.columnDefs||"",order:e.order||[],createdRow:e.createdRow||null,searching:e.searching&&!0,info:e.info&&!0,ordering:e.ordering&&!0};e.scrollX&&(t.scrollX=e.scrollX);var r=void 0;return r=a?$("#"+e.id).dataTable(t):$("#"+e.id).DataTable(t)}function r(e,a,t,r){$("#"+e+" tbody").off(a,t).on(a,t,r)}function l(e){var a=$("#"+e).DataTable().row($(this).parents("tr")).data();return a}Object.defineProperty(a,"__esModule",{value:!0}),a.default=t,a.bindTableEvent=r,a.getTableItem=l},13:function(e,a){"use strict";function t(e){$(e).iCheck({checkboxClass:"icheckbox_minimal-blue",radioClass:"iradio_minimal-blue",disabledClass:"disabled"})}Object.defineProperty(a,"__esModule",{value:!0}),a.default=t},141:function(e,a){"use strict";function t(e){for(var a=[],t={},r=0;r<e.length;r++)t[e[r]]||(a.push(e[r]),t[e[r]]=1);return a}function r(e){if(!isNaN(Number(e))&&Number(e)&&Number(e)>=0){for(var a=0,t=["B","KB","M","G","T"];Math.abs(e)>=1024&&(e/=1024,a++,4!==a););var r=Number(e).toFixed(2);return r+" "+t[a]}return"0B"}function l(e,a){if(!e)return"-";var t=0,r=0,l="";r=e.length;for(var i=0;i<r;i++){var n=e.charAt(i);if(t++,escape(n).length>4&&t++,l=l.concat(n),t>=a)return l=l.concat("...")}return t<a?e:void 0}function i(e,a){var t={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in t)new RegExp("("+r+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?t[r]:("00"+t[r]).substr((""+t[r]).length)));return a}Object.defineProperty(a,"__esModule",{value:!0}),a.arrayUnique=t,a.unitTransform=r,a.cutStr=l,a.dateFormat=i},616:function(e,a,t){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(a,"__esModule",{value:!0});var l=t(5),i=r(l),n=t(6),s=r(n),d=t(3),o=r(d),c=t(4),p=r(c),u=t(8),b=r(u),v=t(7),f=r(v),m=t(2),h=r(m),g=t(147),y=r(g),x=t(12),k=r(x),C=t(141),N=t(13),R=r(N),T=t(10),w=(0,i.default)("div",{className:""},void 0,(0,i.default)("table",{id:"roleList",className:"table table-bordered"},void 0,(0,i.default)("thead",{},void 0,(0,i.default)("tr",{},void 0,(0,i.default)("th",{},void 0,"角色名"),(0,i.default)("th",{},void 0,"角色描述"))))),B=(0,i.default)("div",{className:""},void 0,(0,i.default)("table",{id:"userList",className:"table table-bordered"},void 0,(0,i.default)("thead",{},void 0,(0,i.default)("tr",{},void 0,(0,i.default)("th",{},void 0,"用户名"),(0,i.default)("th",{},void 0,"姓名"))))),P=(0,i.default)("div",{className:"box-header with-border "},void 0,(0,i.default)("p",{className:"box-title"},void 0,"资源信息")),A=(0,i.default)("label",{htmlFor:"datasetName"},void 0,"资源名称 : "),D=(0,i.default)("label",{htmlFor:"isPartition"},void 0,"描述 : "),U=(0,i.default)("label",{htmlFor:"isVisible"},void 0,"所有者 : "),H=(0,i.default)("div",{className:"box-header with-border "},void 0,(0,i.default)("p",{className:"box-title"},void 0,"角色授权")),S=(0,i.default)("div",{className:"box-header with-border "},void 0,(0,i.default)("p",{className:"box-title"},void 0,"用户授权")),_=(0,i.default)("thead",{className:"hide"},void 0),q=(0,i.default)("i",{className:"fa fa-save"}),E=(0,i.default)("i",{className:"fa fa-save"}),M=function(e){function a(e){(0,o.default)(this,a);var t=(0,b.default)(this,(a.__proto__||(0,s.default)(a)).call(this,e));return t.removeRoleOKHandler=t.removeRoleOKHandler.bind(t),t.addRoleHandler=t.addRoleHandler.bind(t),t.createRoleTable=t.createRoleTable.bind(t),t.createRoleResTable=t.createRoleResTable.bind(t),t.filterDetail=t.filterDetail.bind(t),t.createFilterHandler=t.createFilterHandler.bind(t),t.removeUserOKHandler=t.removeUserOKHandler.bind(t),t.addUserHandler=t.addUserHandler.bind(t),t.createUserTable=t.createUserTable.bind(t),t.filterUserDetail=t.filterUserDetail.bind(t),t.createUserFilterHandler=t.createUserFilterHandler.bind(t),t.saveResPrivilege=t.saveResPrivilege.bind(t),t.cancel=t.cancel.bind(t),t.modelContent=t.modelContent.bind(t),t}return(0,f.default)(a,e),(0,p.default)(a,[{key:"componentWillMount",value:function(){var e={};e.resType=this.props.params.type.toUpperCase(),e.resName=this.props.params.id,this.props.allUserList(),this.props.allRoleList(),this.props.readResPrivilege(e),this.props.selectedRecord(e.resName,e.resType)}},{key:"componentDidUpdate",value:function(){this.createRoleResTable()}},{key:"createRoleResTable",value:function(){for(var e=this.props.resPrivilege.resPrivilegeData.result.data,a=this.props.params.type.toUpperCase(),t=[],r=[],l=0;l<e.length;l++)for(var i in e[l]){var n={},s={};"roleName"==i?(n.name=e[l][i],n.privilege=e[l].privilege[a],e[l].filter&&(n.filter=e[l].filter),t.push(n)):"userName"==i&&(s.name=e[l][i],s.privilege=e[l].privilege[a],e[l].filter&&(s.filter=e[l].filter),r.push(s))}var d={},o=[];"DATASET"==a&&(o=[{className:"textCenter",orderable:!1,data:null,render:function(e,t,r){var l="<span class='row-details row-details-close hide'></span><i class='fa fa-circle-thin'></i>";return"DATASET"===a&&$.inArray("查看",r.privilege)!=-1&&(l="<span class='row-details row-details-close'></span><i class='fa fa-circle-thin hide'></i>"),l},defaultContent:""},{data:"name",className:"textCenter selectName",render:function(e,a,t){var r=t.name||"",l='<span style="cursor: pointer;" title="'+r+'" > '+(0,C.cutStr)(r,20)+"</span> ";return l}},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" name="query" data-name="查看"/> &nbsp 查看</label>';return $.inArray("查看",t.privilege)!=-1&&(r='<label><input type="checkBox" name="query" checked data-name="查看"/> &nbsp 查看</label>'),r},defaultContent:'<label><input type="checkBox" data-name="查看" name="query"/> &nbsp 查看</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="修改"/> &nbsp 修改</label>';return $.inArray("修改",t.privilege)!=-1&&(r='<label><input type="checkBox" data-name="修改" checked/> &nbsp 修改</label>'),r},defaultContent:'<label><input type="checkBox" data-name="修改"/> &nbsp 修改</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="删除"/> &nbsp 删除</label>';return $.inArray("删除",t.privilege)!=-1&&(r='<label><input type="checkBox" data-name="删除" checked/> &nbsp 删除</label>'),r},defaultContent:'<label><input type="checkBox" data-name="删除" /> &nbsp 删除</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="操作"/> &nbsp 操作</label>';return $.inArray("操作",t.privilege)!=-1&&(r='<label><input type="checkBox" checked data-name="操作"/> &nbsp 操作</label>'),r},defaultContent:'<label><input type="checkBox" data-name="操作"/> &nbsp 操作</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="授权"/> &nbsp 管理</label>';return $.inArray("授权",t.privilege)!=-1&&(r='<label><input type="checkBox" checked data-name="授权"/> &nbsp 管理</label>'),r},defaultContent:'<label><input type="checkBox" data-name="授权"/> &nbsp 管理</label>'},{data:null,className:"textCenter",orderable:!1,defaultContent:'<i class="fa fa-trash-o" style="cursor: pointer;" title="删除"></i>'}]),"REPORT"==a&&(o=[{className:"textCenter",orderable:!1,data:null,render:function(e,t,r){var l="<span class='row-details row-details-close hide'></span><i class='fa fa-circle-thin'></i>";return"DATASET"===a&&$.inArray("查看",r.privilege)!=-1&&(l="<span class='row-details row-details-close'></span><i class='fa fa-circle-thin hide'></i>"),l},defaultContent:""},{data:"name",className:"textCenter selectName",render:function(e,a,t){var r=t.name||"",l='<span style="cursor: pointer;" title="'+r+'" > '+(0,C.cutStr)(r,20)+"</span> ";return l}},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" name="query" data-name="查看"/> &nbsp 查看</label>';return $.inArray("查看",t.privilege)!=-1&&(r='<label><input type="checkBox" name="query" checked data-name="查看"/> &nbsp 查看</label>'),r},defaultContent:'<label><input type="checkBox" data-name="查看" name="query"/> &nbsp 查看</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="修改"/> &nbsp 修改</label>';return $.inArray("修改",t.privilege)!=-1&&(r='<label><input type="checkBox" data-name="修改" checked/> &nbsp 修改</label>'),r},defaultContent:'<label><input type="checkBox" data-name="修改"/> &nbsp 修改</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="删除"/> &nbsp 删除</label>';return $.inArray("删除",t.privilege)!=-1&&(r='<label><input type="checkBox" data-name="删除" checked/> &nbsp 删除</label>'),r},defaultContent:'<label><input type="checkBox" data-name="删除" /> &nbsp 删除</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="授权"/> &nbsp 管理</label>';return $.inArray("授权",t.privilege)!=-1&&(r='<label><input type="checkBox" checked data-name="授权"/> &nbsp 管理</label>'),r},defaultContent:'<label><input type="checkBox" data-name="授权"/> &nbsp 管理</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="分析"/> &nbsp 分析</label>';return $.inArray("分析",t.privilege)!=-1&&(r='<label><input type="checkBox" checked data-name="分析"/> &nbsp 分析</label>'),r},defaultContent:'<label><input type="checkBox" data-name="分析"/> &nbsp 分析</label>'},{data:null,className:"textCenter",orderable:!1,defaultContent:'<i class="fa fa-trash-o" style="cursor: pointer;" title="删除"></i>'}]),"PLUGIN"==a&&(o=[{className:"textCenter",orderable:!1,data:null,render:function(e,t,r){var l="<span class='row-details row-details-close hide'></span><i class='fa fa-circle-thin'></i>";return"DATASET"===a&&$.inArray("查看",r.privilege)!=-1&&(l="<span class='row-details row-details-close'></span><i class='fa fa-circle-thin hide'></i>"),l},defaultContent:""},{data:"name",className:"textCenter selectName",render:function(e,a,t){var r=t.name||"",l='<span style="cursor: pointer;" title="'+r+'" > '+(0,C.cutStr)(r,20)+"</span> ";return l}},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" name="query" data-name="查看"/> &nbsp 查看</label>';return $.inArray("查看",t.privilege)!=-1&&(r='<label><input type="checkBox" name="query" checked data-name="查看"/> &nbsp 查看</label>'),r},defaultContent:'<label><input type="checkBox" data-name="查看" name="query"/> &nbsp 查看</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="安装"/> &nbsp 安装</label>';return $.inArray("安装",t.privilege)!=-1&&(r='<label><input type="checkBox" data-name="安装" checked/> &nbsp 安装</label>'),r},defaultContent:'<label><input type="checkBox" data-name="安装"/> &nbsp 安装</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="修改"/> &nbsp 修改</label>';return $.inArray("修改",t.privilege)!=-1&&(r='<label><input type="checkBox" data-name="修改" checked/> &nbsp 修改</label>'),r},defaultContent:'<label><input type="checkBox" data-name="修改"/> &nbsp 修改</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="卸载"/> &nbsp 卸载</label>';return $.inArray("卸载",t.privilege)!=-1&&(r='<label><input type="checkBox" data-name="卸载" checked/> &nbsp 卸载</label>'),r},defaultContent:'<label><input type="checkBox" data-name="卸载" /> &nbsp 卸载</label>'},{data:null,className:"textCenter",orderable:!1,defaultContent:'<i class="fa fa-trash-o" style="cursor: pointer;" title="删除"></i>'}]),"JOB"==a&&(o=[{className:"textCenter",orderable:!1,data:null,render:function(e,t,r){var l="<span class='row-details row-details-close hide'></span><i class='fa fa-circle-thin'></i>";return"DATASET"===a&&$.inArray("查看",r.privilege)!=-1&&(l="<span class='row-details row-details-close'></span><i class='fa fa-circle-thin hide'></i>"),l},defaultContent:""},{data:"name",className:"textCenter selectName",render:function(e,a,t){var r=t.name||"",l='<span style="cursor: pointer;" title="'+r+'" > '+(0,C.cutStr)(r,20)+"</span> ";return l}},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" name="query" data-name="查看"/> &nbsp 查看</label>';return $.inArray("查看",t.privilege)!=-1&&(r='<label><input type="checkBox" name="query" checked data-name="查看"/> &nbsp 查看</label>'),r},defaultContent:'<label><input type="checkBox" data-name="查看" name="query"/> &nbsp 查看</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="修改"/> &nbsp 修改</label>';return $.inArray("修改",t.privilege)!=-1&&(r='<label><input type="checkBox" data-name="修改" checked/> &nbsp 修改</label>'),r},defaultContent:'<label><input type="checkBox" data-name="修改"/> &nbsp 修改</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="删除"/> &nbsp 删除</label>';return $.inArray("删除",t.privilege)!=-1&&(r='<label><input type="checkBox" data-name="删除" checked/> &nbsp 删除</label>'),r},defaultContent:'<label><input type="checkBox" data-name="删除" /> &nbsp 删除</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="操作"/> &nbsp 操作</label>';return $.inArray("操作",t.privilege)!=-1&&(r='<label><input type="checkBox" checked data-name="操作"/> &nbsp 操作</label>'),r},defaultContent:'<label><input type="checkBox" data-name="操作"/> &nbsp 操作</label>'},{data:null,className:"textCenter",orderable:!1,defaultContent:'<i class="fa fa-trash-o" style="cursor: pointer;" title="删除"></i>'}]),"DASHBOARD"==a&&(o=[{className:"textCenter",orderable:!1,data:null,render:function(e,t,r){var l="<span class='row-details row-details-close hide'></span><i class='fa fa-circle-thin'></i>";return"DATASET"===a&&$.inArray("查看",r.privilege)!=-1&&(l="<span class='row-details row-details-close'></span><i class='fa fa-circle-thin hide'></i>"),l},defaultContent:""},{data:"name",className:"textCenter selectName",render:function(e,a,t){var r=t.name||"",l='<span style="cursor: pointer;" title="'+r+'" > '+(0,C.cutStr)(r,20)+"</span> ";return l}},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" name="query" data-name="查看"/> &nbsp 查看</label>';return $.inArray("查看",t.privilege)!=-1&&(r='<label><input type="checkBox" name="query" checked data-name="查看"/> &nbsp 查看</label>'),r},defaultContent:'<label><input type="checkBox" data-name="查看" name="query"/> &nbsp 查看</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="修改"/> &nbsp 修改</label>';return $.inArray("修改",t.privilege)!=-1&&(r='<label><input type="checkBox" data-name="修改" checked/> &nbsp 修改</label>'),r},defaultContent:'<label><input type="checkBox" data-name="修改"/> &nbsp 修改</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="删除"/> &nbsp 删除</label>';return $.inArray("删除",t.privilege)!=-1&&(r='<label><input type="checkBox" data-name="删除" checked/> &nbsp 删除</label>'),r},defaultContent:'<label><input type="checkBox" data-name="删除" /> &nbsp 删除</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="授权"/> &nbsp 管理</label>';return $.inArray("授权",t.privilege)!=-1&&(r='<label><input type="checkBox" checked data-name="授权"/> &nbsp 管理</label>'),r},defaultContent:'<label><input type="checkBox" data-name="授权"/> &nbsp 管理</label>'},{data:"privilege",className:"textCenter",orderable:!1,render:function(e,a,t){var r='<label><input type="checkBox" data-name="分析"/> &nbsp 分析</label>';return $.inArray("分析",t.privilege)!=-1&&(r='<label><input type="checkBox" checked data-name="分析"/> &nbsp 分析</label>'),r},defaultContent:'<label><input type="checkBox" data-name="分析"/> &nbsp 分析</label>'},{data:null,className:"textCenter",orderable:!1,defaultContent:'<i class="fa fa-trash-o" style="cursor: pointer;" title="删除"></i>'}]),d.id="roleResPrivilege",d.columns=o,d.data=t,d.paging=!1,(0,k.default)(d),$('input[name="query"]').on("ifChanged",function(e){"DATASET"==a&&($(e.currentTarget).is(":checked")?($("span.row-details",$(e.currentTarget).closest("tr")).removeClass("hide"),$("i.fa-circle-thin",$(e.currentTarget).closest("tr")).addClass("hide")):($("span.row-details",$(e.currentTarget).closest("tr")).addClass("hide"),$("i.fa-circle-thin",$(e.currentTarget).closest("tr")).removeClass("hide")))});var c=$("#roleResPrivilege").DataTable();$("#roleResPrivilege").on("click","tbody td .fa-trash-o",function(){var e=$(this).parents("tr"),a=c.row(e);a.remove(),c.draw()}),$("#roleResPrivilege").on("click","tbody td .row-details",this.filterDetail);var p={};p.id="userResPrivilege",p.columns=o,p.data=r,p.paging=!1,(0,k.default)(p),$('input[name="query"]',$("#userResPrivilege")).on("ifChanged",function(e){"DATASET"==a&&($(e.currentTarget).is(":checked")?($("span.row-details",$(e.currentTarget).closest("tr")).removeClass("hide"),$("i.fa-circle-thin",$(e.currentTarget).closest("tr")).addClass("hide")):($("span.row-details",$(e.currentTarget).closest("tr")).addClass("hide"),$("i.fa-circle-thin",$(e.currentTarget).closest("tr")).removeClass("hide")))});var u=$("#userResPrivilege").DataTable();$("#userResPrivilege").on("click","tbody td .fa-trash-o",function(){var e=$(this).parents("tr"),a=u.row(e);a.remove(),u.draw()}),$("#userResPrivilege").on("click","tbody td .row-details",this.filterUserDetail),(0,R.default)('input[type = "checkBox"]')}},{key:"createRoleTable",value:function(){var e={};e.id="roleList",e.columns=[{data:"roleName",autoWidth:!0,render:function(e,a,t){var r=t.roleName||"",l='<span style="cursor: pointer;" title="'+r+'" > '+(0,C.cutStr)(r,20)+"</span> ";return l}},{data:"desc",orderable:!1,defaultContent:"-",autoWidth:!0,render:function(e,a,t){var r=t.desc||"",l='<span style="cursor: pointer;" title="'+r+'" > '+(0,C.cutStr)(r,70)+"</span> ";return l}}],this.props.allRoleList();var a=this.props.resPrivilege.allRoleList.member;e.data=a;var t=[];if($("#roleResPrivilege").attr("name"))for(var r=$("#roleResPrivilege").attr("name").split(","),l=0;l<r.length;l++)t.push(r[l]);for(var i=0;i<a.length;i++)for(var n=0;n<t.length;n++)a[i].roleName==t[n]&&a.splice(i,1);(0,k.default)(e),$("#roleList tbody").off().on("click","tr",function(e){$(e.currentTarget).toggleClass("selected")})}},{key:"addRoleHandler",value:function(){var e=$("#roleResPrivilege").DataTable().column(1).data().join();$("#roleResPrivilege").attr("name",e);var a=w;this.refs.addRole.setContent(a)}},{key:"createUserTable",value:function(){var e={};e.id="userList",e.columns=[{data:"userName",autoWidth:!0,render:function(e,a,t){var r=t.userName||"",l='<span style="cursor: pointer;" title="'+r+'" > '+(0,C.cutStr)(r,20)+"</span> ";return l}},{data:"name",orderable:!1,defaultContent:"-",autoWidth:!0,render:function(e,a,t){var r=t.name||"",l='<span style="cursor: pointer;" title="'+r+'" > '+(0,C.cutStr)(r,70)+"</span> ";return l}}],this.props.allUserList();var a=this.props.resPrivilege.allUserList.member;e.data=a;var t=[];if($("#userResPrivilege").attr("name"))for(var r=$("#userResPrivilege").attr("name").split(","),l=0;l<r.length;l++)t.push(r[l]);for(var i=0;i<a.length;i++)for(var n=0;n<t.length;n++)a[i].userName==t[n]&&a.splice(i,1);(0,k.default)(e),$("#userList tbody").off().on("click","tr",function(e){$(e.currentTarget).toggleClass("selected")})}},{key:"addUserHandler",value:function(){var e=$("#userResPrivilege").DataTable().column(1).data().join();$("#userResPrivilege").attr("name",e);var a=B;this.refs.addUser.setContent(a)}},{key:"filterDetail",value:function(e){var a=$("#roleResPrivilege").DataTable(),t=$(e.currentTarget).parents("tr"),r=a.row(t);if(r.child.isShown()){$(e.currentTarget).addClass("row-details-close").removeClass("row-details-open");var l=r.child().find("textarea"),i=l.val();t.attr("filter",i),r.child.hide()}else{if($(e.currentTarget).addClass("row-details-open").removeClass("row-details-close"),r.child())return void r.child.show();this.createFilterHandler(r)}}},{key:"filterUserDetail",value:function(e){var a=$("#userResPrivilege").DataTable(),t=$(e.currentTarget).parents("tr"),r=a.row(t);if(r.child.isShown()){$(e.currentTarget).addClass("row-details-close").removeClass("row-details-open");var l=r.child().find("textarea"),i=l.val();t.attr("filter",i),r.child.hide()}else{if($(e.currentTarget).addClass("row-details-open").removeClass("row-details-close"),r.child())return void r.child.show();this.createUserFilterHandler(r)}}},{key:"createFilterHandler",value:function(e){var a=e.data().filter?e.data().filter:"";e.child('\n        <div class="">\n            <div class="form-group col-md-8" id="nestRole_'+e.index()+'">\n                <label for="rolefilterInput_'+e.index()+'">过滤条件: &nbsp <textarea type="text" id="rolefilterInput_'+e.index()+'" class="form-control" style="max-width: 1400px">'+a+"</textarea></label>\n            </div>\n        </div>").show()}},{key:"createUserFilterHandler",value:function(e){var a=e.data().filter?e.data().filter:"";e.child('\n        <div class="">\n            <div class="form-group col-md-8" id="nestUser_'+e.index()+'">\n                <label for="userfilterInput_'+e.index()+'">过滤条件: &nbsp <textarea type="text" id="userfilterInput_'+e.index()+'" class="form-control" style="max-width: 1400px" >'+a+"</textarea></label>\n            </div>\n        </div>").show()}},{key:"removeRoleOKHandler",value:function(){for(var e=[],a=this.props.params.type.toUpperCase(),t=$("#roleList").DataTable().rows(".selected").data(),r=0;r<t.length;r++)e.push($("#roleList").DataTable().rows(".selected").data()[r].roleName);for(var l=$("#roleResPrivilege").DataTable(),i=0;i<e.length;i++)l.row.add({name:e[i]}).draw();(0,R.default)('input[ type = "checkBox"]'),$('input[name="query"]').on("ifChanged",function(e){"DATASET"==a&&($(e.currentTarget).is(":checked")?($("span.row-details",$(e.currentTarget).closest("tr")).removeClass("hide"),$("i.fa-circle-thin",$(e.currentTarget).closest("tr")).addClass("hide")):($("span.row-details",$(e.currentTarget).closest("tr")).addClass("hide"),$("i.fa-circle-thin",$(e.currentTarget).closest("tr")).removeClass("hide")))}),$("#addRole").modal("hide")}},{key:"removeUserOKHandler",value:function(){for(var e=[],a=this.props.params.type.toUpperCase(),t=$("#userList").DataTable().rows(".selected").data(),r=0;r<t.length;r++)e.push($("#userList").DataTable().rows(".selected").data()[r].userName);for(var l=$("#userResPrivilege").DataTable(),i=0;i<e.length;i++)l.row.add({name:e[i]}).draw();(0,R.default)('input[ type = "checkBox"]'),$('input[name="query"]').on("ifChanged",function(e){"DATASET"==a&&($(e.currentTarget).is(":checked")?($("span.row-details",$(e.currentTarget).closest("tr")).removeClass("hide"),$("i.fa-circle-thin",$(e.currentTarget).closest("tr")).addClass("hide")):($("span.row-details",$(e.currentTarget).closest("tr")).addClass("hide"),$("i.fa-circle-thin",$(e.currentTarget).closest("tr")).removeClass("hide")))}),$("#addUser").modal("hide")}},{key:"saveResPrivilege",value:function(){var e=this.props.params.type.toUpperCase(),a=this.props.params.id,t={};if(t.data=[],$("span.row-details-close",$("#roleResPrivilege")).click(),$("span.row-details-open",$("#roleResPrivilege")).click(),$("span.row-details-open",$("#userResPrivilege")).click(),0!=$("tbody tr input",$("#roleResPrivilege")).length)for(var r=0;r<$("tbody tr",$("#roleResPrivilege")).length;r++){var l=$("tbody tr",$("#roleResPrivilege"))[r],i={};i.roleName=$("td",l).eq(1).text().trim(),i.resType=e,i.resName=a,i.privilege={},i.privilege[e]=[];for(var n=0;n<$("input",l).length;n++)$("input",l)[n].checked&&i.privilege[e].push($("input",l).eq(n).attr("data-name"));t.data.push(i)}if(0!=$("tbody tr input",$("#userResPrivilege")).length)for(var s=0;s<$("tbody tr",$("#userResPrivilege")).length;s++){var d=$("tbody tr",$("#userResPrivilege"))[s],o={};o.userName=$("td",d).eq(1).text().trim(),o.resType=e,o.resName=a,o.privilege={},o.privilege[e]=[];for(var c=0;c<$("input",d).length;c++)$("input",d)[c].checked&&o.privilege[e].push($("input",d).eq(c).attr("data-name"));t.data.push(o)}if(0==$("tbody tr input",$("#userResPrivilege")).length&&0==$("tbody tr input",$("#roleResPrivilege")).length){var p={};p.resType=e,p.resName=a,p.privilege=[],t.data.push(p)}this.props.checkResPrivilege(t.data);var u=this.props.resPrivilege.checkResPrivilege,b=u.result.detail.add,v=u.result.detail.remove;if("0"!=u.code)return void(0,T.error)(u.msg);var f="";if(0!=b.length||0!=v.length){for(var m=0;m<b.length;m++)f="<li>因 <mark>"+b[m].dependency+"</mark> 权限添加, 其依赖权限影响的 <u> "+b[m].privileges+" </u> 权限将被 <strong>自动添加</strong> ;</li>",$("#dependency").append(f);for(var h=0;h<v.length;h++)f="<li>因 <mark>"+v[h].dependency+"</mark> 权限移除, 其依赖权限影响的 <u>"+v[h].privileges+"</u> 权限将被 <strong>自动移除</strong> ;</li>",$("#dependency").append(f)}}},{key:"modifyOKHandle",value:function(){var e=this.props.params.type.toUpperCase(),a=this.props.params.id,t={};if(t.data=[],$("span.row-details-close",$("#roleResPrivilege")).click(),$("span.row-details-open",$("#roleResPrivilege")).click(),$("span.row-details-open",$("#userResPrivilege")).click(),0!=$("tbody tr input",$("#roleResPrivilege")).length)for(var r=0;r<$("tbody tr",$("#roleResPrivilege")).length;r++){var l=$("tbody tr",$("#roleResPrivilege"))[r],i=$('input[name="query"]',l).is(":checked"),n={};n.roleName=$("td",l).eq(1).text().trim(),n.resType=e,n.resName=a,n.privilege={},n.privilege[e]=[];for(var s=0;s<$("input",l).length;s++)$("input",l)[s].checked&&n.privilege[e].push($("input",l).eq(s).attr("data-name"));"DATASET"==e&&i&&(n.filter=$(l).attr("filter")?$(l).attr("filter"):""),t.data.push(n)}if(0!=$("tbody tr input",$("#userResPrivilege")).length)for(var d=0;d<$("tbody tr",$("#userResPrivilege")).length;d++){var o=$("tbody tr",$("#userResPrivilege"))[d],c=$('input[name="query"]',o).is(":checked"),p={};p.userName=$("td",o).eq(1).text().trim(),p.resType=e,p.resName=a,p.privilege={},p.privilege[e]=[];for(var u=0;u<$("input",o).length;u++)$("input",o)[u].checked&&p.privilege[e].push($("input",o).eq(u).attr("data-name"));"DATASET"==e&&c&&(p.filter=$(o).attr("filter")?$(o).attr("filter"):""),t.data.push(p)}if(0==$("tbody tr input",$("#userResPrivilege")).length&&0==$("tbody tr input",$("#roleResPrivilege")).length){var b={};b.resType=e,b.resName=a,b.privilege=[],t.data.push(b)}this.props.createResPrivilege(t.data),$("#resModify").modal("hide"),this.props.history.replace("/"+this.props.params.type)}},{key:"modelContent",value:function(){var e=this.props.params.id,a=(0,i.default)("ol",{id:"dependency",className:"todo-list ui-sortable"},void 0,(0,i.default)("li",{},void 0,"您确定要对资源： ",(0,i.default)("strong",{},void 0,e)," 进行授权吗？"));$("#dependency").html(""),this.refs.resModify.setContent(a)}},{key:"cancel",value:function(){this.props.history.replace("/"+this.props.params.type)}},{key:"render",value:function(){var e="";return e=this.props.resPrivilege.selectedRecord.desc?this.props.resPrivilege.selectedRecord.desc:" 无",(0,i.default)("div",{id:"resPrivilege"},void 0,(0,i.default)("div",{className:"box box-primary"},void 0,P,(0,i.default)("div",{className:"box-body"},void 0,(0,i.default)("div",{className:""},void 0,(0,i.default)("div",{className:"col-md-12 form-group"},void 0,A,(0,i.default)("span",{className:"detailSpan ml10"},void 0,this.props.params.id)),(0,i.default)("div",{name:"isPartition",className:"form-group col-md-12"},void 0,D,(0,i.default)("span",{className:"detailSpan ml10"},void 0,e)),(0,i.default)("div",{name:"isVisible",className:"form-group col-md-12"},void 0,U,(0,i.default)("span",{className:"detailSpan ml10"},void 0,this.props.resPrivilege.selectedRecord.owner))))),(0,i.default)("div",{className:"box box-primary"},void 0,H,(0,i.default)("div",{className:"box-body"},void 0,(0,i.default)("div",{className:"box-header pull-left"},void 0,(0,i.default)("button",{type:"submit",name:"createDataset",className:"btn btn-primary","data-toggle":"modal","data-target":"#addRole",onClick:this.addRoleHandler},void 0,(0,i.default)("i",{className:"fa fa-fw fa-plus-circle",style:{verticalAlign:"middle",padding:"0 8px 0 0"}}),"添加角色")),(0,i.default)("div",{className:"box-body"},void 0,(0,i.default)("table",{id:"roleResPrivilege",className:"table table-striped table-bordered",style:{width:"100%"}},void 0,(0,i.default)("thead",{className:"hide"},void 0))))),(0,i.default)("div",{className:"box box-primary"},void 0,S,(0,i.default)("div",{className:"box-body"},void 0,(0,i.default)("div",{className:"box-header pull-left"},void 0,(0,i.default)("button",{type:"submit",name:"createDataset",className:"btn btn-primary","data-toggle":"modal","data-target":"#addUser",onClick:this.addUserHandler},void 0,(0,i.default)("i",{className:"fa fa-fw fa-plus-circle",style:{verticalAlign:"middle",padding:"0 8px 0 0"}}),"添加用户")),(0,i.default)("div",{className:"box-body"},void 0,(0,i.default)("table",{id:"userResPrivilege",className:"table table-striped table-bordered",style:{width:"100%"}},void 0,_)))),h.default.createElement(y.default,{modalId:"addRole",ref:"addRole",title:"选择角色 ( 点击列表进行选择 ) ",okHandler:this.removeRoleOKHandler,loadModalControlHandler:this.createRoleTable}),h.default.createElement(y.default,{modalId:"addUser",ref:"addUser",title:"选择角色 ( 点击列表进行选择 ) ",okHandler:this.removeUserOKHandler,loadModalControlHandler:this.createUserTable}),(0,i.default)("button",{name:"saveBtn",className:"btn btn-primary",onClick:this.cancel},void 0,q," 取消 "),(0,i.default)("button",{name:"saveBtn","data-toggle":"modal","data-target":"#resModify",className:"btn btn-primary ml15",onClick:this.modelContent},void 0,E," 保存 "),h.default.createElement(y.default,{modalId:"resModify",ref:"resModify",title:"权限依赖确认",loadModalControlHandler:this.saveResPrivilege,okHandler:this.modifyOKHandle.bind(this)}))}}]),a}(m.Component);a.default=M}});